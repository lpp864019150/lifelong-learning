# 线上SQL执行慢，分享3个优化案例

## 参考资料

1. [线上sql执行慢，分享3个优化案例 - 掘金](https://juejin.cn/post/7212192717395771452)

## 坑

1. 未使用到索引，需正确使用索引。
   
   多`explain`查看执行计划，争取每条`SQL`都能用上合适的索引。
   
   改造`SQL`语句来适应索引或者改造索引来使用`SQL`语句

2. 多次执行单条`update`语句，多条累积耗时感人。
   
   可以考虑批量`SQL`，把多条`update`语句合并成单条，使用`CASE WHEN THEN END`来改造拼接，效果显著
   
   当然也要注意一次拼接的数量，已经整体`SQL`的长度，控制数量

3. 一次上传`10w`条记录，即使批量插入耗时依然感人
   
   若已做批量优化效果不佳，可以考虑并发批量执行，开线程来并发批量执行