# 文件描述符

## 参考博文

1. [彻底弄懂 Linux 下的文件描述符（fd）_linux fd管理_杰克小麻雀的博客-CSDN博客](https://blog.csdn.net/yushuaigee/article/details/107883964)
2. [带你破案：文件描述符到底是什么？ - 掘金](https://juejin.cn/post/6844903962043236365)
3. [Linux配置调优：最大打开文件描述符个数 | Idea Buffer](http://www.ideabuffer.cn/2016/11/20/Linux%E9%85%8D%E7%BD%AE%E8%B0%83%E4%BC%98%EF%BC%9A%E6%9C%80%E5%A4%A7%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E4%B8%AA%E6%95%B0/)

## 文件描述符

1. `fdt`，文件描述符数组

2. 通过数组索引来获取文件信息，所以描述符是一个非负整数

3. 其中`0`，`1`，`2`有特殊用途，`0`为标准输入，`1`为标准输出，`2`为错误输出

4. 首次打开文件，描述符为`3`，接着是`4`，当某个文件关闭回收了描述符，后面打开的文件可以使用之前回收的描述符

5. 描述符上限分系统级、用户级，系统级`cat /proc/sys/fs/file-max`，用户级：`ulimit -n`

6. 理论上有多少内存就可以有多少描述符，但是系统不可能只处理文件描述符，一般以内存的`10%`来算(`KB`)

7. `32`位的`ulimit`为`1024`，`64`为`65535`，这里限制的是单个进程的文件描述符，非系统级

8. 每个进程有自己单独的文件描述符数组，进程间互不干扰

## 修改最大文件限制数量的方式

1. 通过`ulimit -n`修改
2. 通过`/etc/security/limits.conf`文件来修改
3. 通过`/proc/sys/fs/file-max`文件来修改