# 用户态与内核态

## 参考资料

1. [用户态与内核态 -- 帮你解惑，直达本质 - 掘金](https://juejin.cn/post/6920621924791894023)

## 概念

1. 用户态
   
   用户空间，应用程序执行的地方，内存空间受限，CPU指令集受限
   
   不可访问外网设备
   
   占用CPU的能力被剥夺，CPU资源可以被其他程序获取

2. 内核态
   
   内核空间，需要内核执行的地方，一些高级别的CPU指令只能在内核空间执行，比如I/O

3. CPU指令
   
   区分权限，有0-3四个级别，0代表最高级别，3代表最低级别。通过不同等级来区分内核态和用户态
   
   内核态拥有最高级别，也就是0，可以执行操作所有的CPU指令集
   
   用户态只有级别3，很多指令集无法执行，若要执行则需要切换到内核态方可执行。应用程序就是在用户态里执行，比如我们的进程。

4. 进程
   
   系统分配资源的最小单位
   
   申请的是内存资源

5. 线程
   
   CPU资源的最小单位
   
   竞争的是CPU资源
   
   每个进程里至少有一个线程，不支持多线程的语言在进程里依然有一个单线程

6. 协程
   
   在用户空间执行，由用户维护，不涉及到用户空间和内核空间的切换

## 用户态和内核态切换

1. 系统调用
   
   用户态主动切换到内核态

2. 异常
   
   用户态发生了异常，需要切换到内核态来处理异常

3. 中断
   
   外部设备通过中断来通知CPU进行处理，此时内核态需要接管，自然就由正在执行的用户态切换到了内核态，然后处理中断时又要从内核态切换到处理中断的那个进程，自然又从内核态切换到了用户态
